<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A study guide for the AWS Certified Developer - Associate (DVA-C02) exam."><meta name=author content="Javier Vanoli"><link href=https://jvanoli.github.io/dva-c02-study-guide/AWS%20Deep%20Dives/AWS%20Lambda/ rel=canonical><link href=../AWS%20STS/ rel=prev><link href=../Amazon%20API%20Gateway/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>AWS Lambda - AWS Certified Developer (DVA-C02) Study Guide</title><link rel=stylesheet href=../../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CIMB+Plex+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Noto Sans";--md-code-font:"IMB Plex Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#aws-lambda class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="AWS Certified Developer (DVA-C02) Study Guide" class="md-header__button md-logo" aria-label="AWS Certified Developer (DVA-C02) Study Guide" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AWS Certified Developer (DVA-C02) Study Guide </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> AWS Lambda </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=light-blue data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jvanoli/dva-c02-study-guide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> View in Github </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="AWS Certified Developer (DVA-C02) Study Guide" class="md-nav__button md-logo" aria-label="AWS Certified Developer (DVA-C02) Study Guide" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> AWS Certified Developer (DVA-C02) Study Guide </label> <div class=md-nav__source> <a href=https://github.com/jvanoli/dva-c02-study-guide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> View in Github </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg> <span class=md-ellipsis> AWS Certified Developer (DVA-C02) Study Guide </span> </a> </li> <li class=md-nav__item> <a href=../../Introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../Exam%20Overview/ class=md-nav__link> <span class=md-ellipsis> Exam Overview </span> </a> </li> <li class=md-nav__item> <a href=../../Study%20Guide%20and%20Tips/ class=md-nav__link> <span class=md-ellipsis> Study Guide and Tips </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> AWS Deep Dives </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> AWS Deep Dives </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../AWS%20Identity%20Access%20Management%20%28IAM%29/ class=md-nav__link> <span class=md-ellipsis> AWS Identity Access Management (IAM) </span> </a> </li> <li class=md-nav__item> <a href=../AWS%20STS/ class=md-nav__link> <span class=md-ellipsis> AWS STS </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> AWS Lambda </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> AWS Lambda </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#synchronous-vs-asynchronous-invocations class=md-nav__link> <span class=md-ellipsis> Synchronous vs. Asynchronous Invocations </span> </a> <nav class=md-nav aria-label="Synchronous vs. Asynchronous Invocations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#synchronous class=md-nav__link> <span class=md-ellipsis> Synchronous </span> </a> </li> <li class=md-nav__item> <a href=#asynchronous class=md-nav__link> <span class=md-ellipsis> Asynchronous </span> </a> </li> <li class=md-nav__item> <a href=#handling-failed-asynchronous-invocations class=md-nav__link> <span class=md-ellipsis> Handling failed asynchronous invocations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#event-source-mappings class=md-nav__link> <span class=md-ellipsis> Event source mappings </span> </a> </li> <li class=md-nav__item> <a href=#event-filtering class=md-nav__link> <span class=md-ellipsis> Event filtering </span> </a> </li> <li class=md-nav__item> <a href=#execution-environment-lifecycle class=md-nav__link> <span class=md-ellipsis> Execution Environment Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=#reducing-cold-starts class=md-nav__link> <span class=md-ellipsis> Reducing Cold Starts </span> </a> </li> <li class=md-nav__item> <a href=#execution-environment-reuse class=md-nav__link> <span class=md-ellipsis> Execution Environment Reuse </span> </a> </li> <li class=md-nav__item> <a href=#environment-variables class=md-nav__link> <span class=md-ellipsis> Environment variables </span> </a> </li> <li class=md-nav__item> <a href=#lambda-function-url class=md-nav__link> <span class=md-ellipsis> Lambda function URL </span> </a> </li> <li class=md-nav__item> <a href=#deploying-codes-with-external-dependencies class=md-nav__link> <span class=md-ellipsis> Deploying Codes with External Dependencies </span> </a> </li> <li class=md-nav__item> <a href=#lambda-layers class=md-nav__link> <span class=md-ellipsis> Lambda Layers </span> </a> </li> <li class=md-nav__item> <a href=#concurrency-and-throttling class=md-nav__link> <span class=md-ellipsis> Concurrency and Throttling </span> </a> </li> <li class=md-nav__item> <a href=#connecting-a-lambda-function-to-a-vpc class=md-nav__link> <span class=md-ellipsis> Connecting a Lambda Function to a VPC </span> </a> </li> <li class=md-nav__item> <a href=#versions-and-aliases class=md-nav__link> <span class=md-ellipsis> Versions and Aliases </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Amazon%20API%20Gateway/ class=md-nav__link> <span class=md-ellipsis> Amazon API Gateway‬ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#synchronous-vs-asynchronous-invocations class=md-nav__link> <span class=md-ellipsis> Synchronous vs. Asynchronous Invocations </span> </a> <nav class=md-nav aria-label="Synchronous vs. Asynchronous Invocations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#synchronous class=md-nav__link> <span class=md-ellipsis> Synchronous </span> </a> </li> <li class=md-nav__item> <a href=#asynchronous class=md-nav__link> <span class=md-ellipsis> Asynchronous </span> </a> </li> <li class=md-nav__item> <a href=#handling-failed-asynchronous-invocations class=md-nav__link> <span class=md-ellipsis> Handling failed asynchronous invocations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#event-source-mappings class=md-nav__link> <span class=md-ellipsis> Event source mappings </span> </a> </li> <li class=md-nav__item> <a href=#event-filtering class=md-nav__link> <span class=md-ellipsis> Event filtering </span> </a> </li> <li class=md-nav__item> <a href=#execution-environment-lifecycle class=md-nav__link> <span class=md-ellipsis> Execution Environment Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=#reducing-cold-starts class=md-nav__link> <span class=md-ellipsis> Reducing Cold Starts </span> </a> </li> <li class=md-nav__item> <a href=#execution-environment-reuse class=md-nav__link> <span class=md-ellipsis> Execution Environment Reuse </span> </a> </li> <li class=md-nav__item> <a href=#environment-variables class=md-nav__link> <span class=md-ellipsis> Environment variables </span> </a> </li> <li class=md-nav__item> <a href=#lambda-function-url class=md-nav__link> <span class=md-ellipsis> Lambda function URL </span> </a> </li> <li class=md-nav__item> <a href=#deploying-codes-with-external-dependencies class=md-nav__link> <span class=md-ellipsis> Deploying Codes with External Dependencies </span> </a> </li> <li class=md-nav__item> <a href=#lambda-layers class=md-nav__link> <span class=md-ellipsis> Lambda Layers </span> </a> </li> <li class=md-nav__item> <a href=#concurrency-and-throttling class=md-nav__link> <span class=md-ellipsis> Concurrency and Throttling </span> </a> </li> <li class=md-nav__item> <a href=#connecting-a-lambda-function-to-a-vpc class=md-nav__link> <span class=md-ellipsis> Connecting a Lambda Function to a VPC </span> </a> </li> <li class=md-nav__item> <a href=#versions-and-aliases class=md-nav__link> <span class=md-ellipsis> Versions and Aliases </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href="https://github.com/jvanoli/dva-c02-study-guide/edit/main/docs/AWS Deep Dives/AWS Lambda.md" title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <h1 id=aws-lambda>AWS Lambda<a class=headerlink href=#aws-lambda title="Permanent link">&para;</a></h1> <p>AWS Lambda lets you run codes without managing servers. You don't need to worry about tasks such as scaling, patching, and other management operations that are typically done on EC2 instances or on-premises servers. You can allot the maximum memory available for a Lambda function, as well as the function's execution duration, before timing out. The memory, which scales proportionally to the CPU power, can range from 128 MB to 10,240 MB in 1-MB increments. The default timeout is three seconds, with a maximum value of 900 seconds (15 minutes).</p> <p>A Lambda function can be invoked in different ways. You can invoke a function directly on the AWS Lambda console, via the <code>Invoke</code> API/CLI command, or through a <a href=#lambda-function-url>Function URL</a> . You can set up certain AWS Services to invoke a Lambda function as well. For example, you can create a Lambda function that responds to Amazon S3 events (e.g. <em>processing files as they are uploaded to an S3 bucket</em>) or set up an Amazon EventBridge rule that triggers a Lambda function every week to perform batch processing. Lambda functions are also commonly used as a backend for APIs that do not require constant load, such as handling login requests or on-the-fly image processing.</p> <p><img alt=image-20250107204723652 src=../assets/image-20250107204723652.png></p> <h2 id=synchronous-vs-asynchronous-invocations>Synchronous vs. Asynchronous Invocations<a class=headerlink href=#synchronous-vs-asynchronous-invocations title="Permanent link">&para;</a></h2> <p>There are two invocation types in AWS Lambda.</p> <h3 id=synchronous>Synchronous<a class=headerlink href=#synchronous title="Permanent link">&para;</a></h3> <p>The first type is called <strong>Synchronous</strong> invocation, which is the default. Synchronous invocation is pretty straightforward. When a function is invoked synchronously, AWS Lambda waits until the function is done processing, then returns the result. Let’s see how this works through the following example:</p> <p><img alt=image-20250107205228755 src=../assets/image-20250107205228755.png></p> <p>The image above illustrates a Lambda function-backed API that is managed by API Gateway. When API Gateway receives a GET request from the /getOrder resource, it invokes the getOrder function. The function receives an event containing the payload, processes it, and then returns the result. </p> <p>Considerations when using synchronous invocation:</p> <ul> <li>If you’re planning to integrate AWS Lambda with API Gateway, take note that A<strong>PI Gateway’s integration timeout is 29 seconds</strong>. If a function takes longer than that to complete, the connection will time out, and the request will fail. Hence, use synchronous invocations for applications that don’t take too long to complete (e.g., authorizing requests, and interacting with databases). </li> <li>Synchronously-invoked functions <strong>can accept a payload of up to 6 MB</strong>.</li> <li>You might need to implement a retry logic in your code to handle intermittent errors.</li> </ul> <p>To call a Lambda function synchronously via API/CLI, set RequestResponse as the value for the <code>invocation-type</code> parameter when calling the Invoke command, as shown below:</p> <div class=highlight><pre><span></span><code>aws<span class=w> </span>lambda<span class=w> </span>invoke<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--function-name<span class=w> </span>testFunction<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--invocation-type<span class=w> </span>RequestResponse<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--cli-binary-format<span class=w> </span>raw-in-base64-out<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--payload<span class=w> </span><span class=s1>&#39;{ &quot;input&quot; : &quot;input_value&quot; }&#39;</span><span class=w> </span>response.json
</code></pre></div> <p>Alternatively, you may just omit the <code>invocation-type</code> parameter as AWS Lambda invokes functions synchronously by default.</p> <p>Services that invoke Lambda functions synchronously (<em>services irrelevant to the exam are excluded</em>): * Amazon API Gateway * Application Load Balancer * Amazon Cognito * Amazon Data Firehose * Amazon CloudFront (Lambda@Edge)</p> <h3 id=asynchronous>Asynchronous<a class=headerlink href=#asynchronous title="Permanent link">&para;</a></h3> <p>An Asynchronous invocation is typically used when a client does not need to wait for immediate results from a function. Some examples of these are long-latency processes that run in the background, such as batch operations, video encoding, and order processing.</p> <p>When a function is invoked asynchronously, AWS Lambda stores the event in an internal queue that it manages. Let’s understand asynchronous invocation through the example below:</p> <p><img alt=image-20250107205409596 src=../assets/image-20250107205409596.png></p> <p>A PUT request is made to the <code>/putOrder</code> resource. Like the previous example, the request goes through API Gateway, which produces an event. This time, instead of API Gateway directly invoking the function, AWS Lambda queues the event. If the event is successfully queued, AWS Lambda returns an empty payload with <code>HTTP 202 status code</code>. The <code>202 status code</code> is just a confirmation that the event is queued; it’s not indicative of a successful invocation. The client will not be required to wait for the Lambda function to complete. So, to improve user experience, you can create a worker that tracks order completion and sends notifications once the order is successfully processed.</p> <p>To call a Lambda function asynchronously via the Invoke command, simply set Event as the value for the invocation-type parameter, as shown below:</p> <div class=highlight><pre><span></span><code>aws<span class=w> </span>lambda<span class=w> </span>invoke<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--function-name<span class=w> </span>testFunction<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--invocation-type<span class=w> </span>Event<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--cli-binary-format<span class=w> </span>raw-in-base64-out<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--payload<span class=w> </span><span class=s1>&#39;{ &quot;input&quot; : &quot;input_value&quot; }&#39;</span><span class=w> </span>response.json
</code></pre></div> <p>Considerations when using asynchronous invocation:</p> <ul> <li>Asynchronously-invoked functions can only accept a payload of up to 256 KB.</li> <li>The Lambda service implements a retry logic for asynchronously-invoked functions</li> <li>Good for applications that run in the background (batch processing, video encoding)</li> </ul> <p>Services that invoke Lambda functions asynchronously (<em>services irrelevant to the exam are excluded</em>):</p> <ul> <li>Amazon API Gateway (by specifying Event in the <code>X-Amz-Invocation-Type</code> request header of a non-proxy integration API)</li> <li>Amazon S3</li> <li>Amazon CloudWatch Logs</li> <li>Amazon EventBridge</li> <li>AWS CodeCommit</li> <li>AWS CloudFormation</li> <li>AWS Config</li> </ul> <h3 id=handling-failed-asynchronous-invocations>Handling failed asynchronous invocations<a class=headerlink href=#handling-failed-asynchronous-invocations title="Permanent link">&para;</a></h3> <p>AWS Lambda has a built-in retry mechanism for asynchronous invocations. If the function returns an error, Lambda will attempt to retry the request two more times, with a longer wait interval between each attempt.</p> <p><img alt=image-20250107205639032 src=../assets/image-20250107205639032.png></p> <p>The request is discarded after AWS Lambda has exhausted all remaining retries. To avoid losing events, you may redirect failed request attempts to an SQS dead-letter queue so that you can debug the error later and have another function retry it.</p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-invocation.html>https://docs.aws.amazon.com/lambda/latest/dg/lambda-invocation.html</a></li> <li><a href=https://aws.amazon.com/blogs/architecture/understanding-the-different-ways-to-invoke-lambda-functions/ >https://aws.amazon.com/blogs/architecture/understanding-the-different-ways-to-invoke-lambda-functions/</a></li> </ul> <h2 id=event-source-mappings>Event source mappings<a class=headerlink href=#event-source-mappings title="Permanent link">&para;</a></h2> <p>Stream or queue-based resources such as DynamoDB streams, SQS queues, and Kinesis Data Streams streams do not invoke Lambda functions directly. Typically, we read records from these resources using pollers. A poller is an application that periodically checks a queue, pulls records from it (sometimes in batches), and sends them to a downstream service that will process them.</p> <p><img alt=image-20250107205752280 src=../assets/image-20250107205752280.png></p> <p>An event source mapping is a sort of polling agent that Lambda manages. Event source mappings take away the overhead of writing pollers from scratch to retrieve messages from queues/streams. This allows you to focus on building the domain logic of your application.</p> <p>Event source mapping invokes a function synchronously if one of the following conditions is met:</p> <ol> <li><strong>The batch size is reached</strong> - The minimum batch size can be set to 1, but the default and maximum batch sizes vary on the AWS service that invokes your function.</li> <li><strong>The maximum batching window is reached</strong> - The batching window is the amount of time Lambda waits to gather and batch records. The default batch window for Amazon Kinesis, Amazon DynamoDB, and Amazon SQS is 0. This means that a Lambda function will receive batches as quickly as possible. You can tweak the value of the batch window based on the nature of your application.</li> <li><strong>The total payload is 6 MB</strong> - Because event source mappings invoke functions synchronously, the total payload (event data) that a function can receive is also limited to 6MB (the limit for synchronous invocations). This means that if the maximum record size in a queue is 100KB, then the maximum batch size you can set is 60.</li> </ol> <h2 id=event-filtering>Event filtering<a class=headerlink href=#event-filtering title="Permanent link">&para;</a></h2> <p>A Lambda function is billed based on how long it runs. How often functions are invoked plays a major factor as well. This is why Lambda is great for scheduled jobs, short-duration tasks, and event-based processes. But does this mean you shouldn’t use them for high-volume traffic applications? There is no definitive answer as it will always be on a case-to-case basis. It usually depends on factors such as the requirements of your application and the cost trade-off you’re willing to make. Regardless, if you ever find yourself wanting to use Lambda in a high-activity application like stream processing, it’s good to know that there are methods available to offset the cost of running functions.</p> <p>Batching is one cost optimization technique for Lambda functions. By increasing the batch size value, you can reduce the frequency at which your function runs. In addition, you can also filter events that are only needed by your function, thus lowering the cost even further.</p> <p>Consider the following scenario:</p> <p>You’re tasked to develop a function that reacts to voltage drops or temperature changes that might indicate faulty components in a site. Multiple sensors send readings to a Kinesis Data Stream stream, which must be consumed and processed by a Lambda function.</p> <p>Your first instinct might be to implement filtering logic within the Lambda function, as shown below:</p> <div class=highlight><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>lambda_handler</span> <span class=p>(</span><span class=n>event</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
    <span class=n>temperature</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s2>&quot;temperature&quot;</span><span class=p>]</span>
    <span class=n>voltage</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s2>&quot;voltage&quot;</span><span class=p>]</span>
    <span class=k>if</span> <span class=n>temperature</span> <span class=o>&gt;</span> <span class=mi>100</span> <span class=ow>or</span> <span class=n>voltage</span> <span class=o>&lt;</span> <span class=mi>5</span> <span class=p>:</span>
        <span class=c1>#do something</span>
    <span class=k>else</span> <span class=p>:</span>
        <span class=c1>#do nothing</span>
</code></pre></div> <p>The code may be valid, but it is deemed inefficient due to cost as t<strong>he Lambda function will be invoked unnecessarily with every sensor data transmission, even if it doesn't require processing</strong>. Supposed sensor data is sent every second. This results in 60 invocations per minute at a batch size of 1 and batching window of 0. This can lead to a waste of time and resources if none of the readings contain the desired voltage and temperature values.</p> <p><img alt=image-20250108013718074 src=../assets/image-20250108013718074.png></p> <p>To address this, rather than doing conditional checks for each event at the function level, you should filter the events before they are passed down to your function. Going back to the scenario, since you’re only interested in specific values of voltage and temperature, you can specify a filter pattern using the <code>filter-criteria</code> parameter of the <code>CreateEventSourceMapping</code> command.</p> <div class=highlight><pre><span></span><code>aws<span class=w> </span>lambda<span class=w> </span>create-event-source-mapping<span class=w> </span><span class=se>\</span>
--function-name<span class=w> </span>process-sensor-readings<span class=w> </span><span class=se>\</span>
--batch-size<span class=w> </span><span class=m>10</span><span class=w> </span><span class=se>\</span>
--starting-position<span class=w> </span>LATEST<span class=w> </span><span class=se>\</span>
--event-source-arn<span class=w> </span>arn:aws:kinesis:us-east-1:123456789123:stream/sensors<span class=w> </span><span class=se>\</span>
--filter-criteria<span class=w> </span><span class=s1>&#39;{&quot;Filters&quot;: [{&quot;Pattern&quot;: &quot;{\&quot;temperature\&quot;: [{\&quot;numeric\&quot;: [\&quot;&gt;\&quot;, 100]}]}&quot;},{\&quot;voltage\&quot;: [{\&quot;numeric\&quot;: [\&quot;&lt;\&quot;, 5]}]}]}&#39;</span>
</code></pre></div> <p>A single event source can have up to five unique filters. If an event matches any of the filters, Lambda routes it to your function. Otherwise, the event is discarded. The exam won’t expect you to be an expert in event filtering, but you should be familiar with it at a high level. You may also refer to this for the full list of filter syntax.</p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/invocation-eventfiltering.html>https://docs.aws.amazon.com/lambda/latest/dg/invocation-eventfiltering.html</a></li> <li><a href=https://aws.amazon.com/blogs/compute/filtering-event-sources-for-aws-lambda-functions/ >https://aws.amazon.com/blogs/compute/filtering-event-sources-for-aws-lambda-functions/</a></li> </ul> <h2 id=execution-environment-lifecycle>Execution Environment Lifecycle<a class=headerlink href=#execution-environment-lifecycle title="Permanent link">&para;</a></h2> <p>Lambda functions undergo three phases when invoked. These are:</p> <ol> <li> <p><code>INIT Phase</code></p> <ul> <li>Occurs when a Lambda function is invoked for the <strong>first time after being deployed</strong> or after <strong>a long period of inactivity</strong>.</li> <li>Consists of two stages: <em>environment creation</em> and <em>code initialization</em>.</li> <li><strong>Environment creation</strong> - AWS Lambda creates an instance of a function in an isolated and secure environment inside a micro virtual machine . This 'execution environment' is where the Lambda function code actually runs. Under the hood, AWS Lambda uses a virtualization technology called Firecracker to provision environments. Firecracker makes use of lightweight micro virtual machines, allowing AWS Lambda to create environments quickly, even with a high volume of requests, without sacrificing security or performance. The amount of CPU and memory allocated to the execution environment is determined by the memory settings that you've configured for your Lambda function.</li> <li><strong>Initialization</strong> - after setting up the environment, Lambda pulls your code from Amazon S3 (Lambda function codes are securely stored in Amazon S3) and runs the initialization code. Initialization code is any code written outside of the handler function. These could be your imported dependencies, global variables, objects, etc. <img alt=image-20250108014410325 src=../assets/image-20250108014410325.png></li> <li>The time it takes for the INIT phase to complete adds latency to your function's total execution time. This ‘delay’ caused by the bootstrapping of execution environments is also known as <code>cold start</code> . AWS does not charge for the cold start that happens during the INIT phase; however, initialization times must not exceed 10 seconds</li> </ul> </li> <li> <p><code>INVOKE Phase</code> </p> <ul> <li>This is the stage at which the handler function is run. Once the handler function is done processing, AWS Lambda keeps its execution environment warm (on standby) for a period of time. This allows the function to accept subsequent invocation requests without having to create a new execution environment. As a result, the total execution time of your function is shortened because Lambda does not have to repeat everything that was done during the INIT phase. <img alt=image-20250108014645842 src=../assets/image-20250108014645842.png></li> </ul> </li> <li> <p><code>SHUTDOWN Phase</code></p> <ul> <li>When an execution environment stops getting invocation requests for quite some time, AWS Lambda terminates it. There is no documented time limit, but based on experience, execution environments are normally kept warm for 5-15 minutes, though this can vary.</li> </ul> </li> </ol> <p>The image below illustrates the lifecycle of a Lambda function.</p> <p><img alt=image-20250108014749644 src=../assets/image-20250108014749644.png></p> <p><strong>Reference:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/runtimes-context.html>https://docs.aws.amazon.com/lambda/latest/dg/runtimes-context.html</a></li> </ul> <h2 id=reducing-cold-starts>Reducing Cold Starts<a class=headerlink href=#reducing-cold-starts title="Permanent link">&para;</a></h2> <p>The more libraries/packages you include, the longer your function’s cold start. That said, you have to be aware and careful in choosing which dependencies to import. There are two approaches you can take to deal with cold starts. The first one is to only load what you need. This method is completely free. You simply have to be more specific and concise when it comes to the resources that you include in your function. In doing so, fewer data will be initialized.</p> <p>The second is by using Provisioned Concurrency. Provisioned Concurrency is a Lambda feature that allows you to allot pre-warmed environments for your Lambda functions. This will provide your application with constant latency, allowing it to reply to queries in the low double-digit milliseconds. Take note that Provisioned concurrency is different from Reserved concurrency. However, the concept of shared concurrency is the same. The concurrency limit tied to a Region is divided between Shared concurrency and Provisioned concurrency.</p> <p>References:</p> <ul> <li><a href=https://aws.amazon.com/blogs/compute/operating-lambda-performance-optimization-part-1/ >https://aws.amazon.com/blogs/compute/operating-lambda-performance-optimization-part-1/</a></li> <li><a href=https://aws.amazon.com/blogs/compute/operating-lambda-performance-optimization-part-2/ >https://aws.amazon.com/blogs/compute/operating-lambda-performance-optimization-part-2/</a></li> </ul> <h2 id=execution-environment-reuse>Execution Environment Reuse<a class=headerlink href=#execution-environment-reuse title="Permanent link">&para;</a></h2> <p>Re-using your existing execution environment is all about reusing the config settings, dependencies, global variables, or even database connections that were already initialized during the INIT phase. To reuse, simply place all global variables, database connections, or SDK clients that you have outside of your handler function. </p> <p>Below is an example of a Lambda function code where an initialized resource is not taken advantage of. You can see that the database client is written inside the function handler.</p> <p><img alt=image-20250108015245404 src=../assets/image-20250108015245404.png></p> <p>If this is the case, your function will open a new database connection every time it is invoked, which is costly compute-wise and adds latency to the execution time. To eliminate this extra time, move the connection object outside the handler function so that it is only initialized once. This way, subsequent requests would be able to reconnect to the existing connection. You are charged for the time it takes your function to run, so a shorter execution duration means you’d pay less.</p> <p>In addition, keep in mind that each execution environment offers a <strong>512 MB - 10 GB of temporary storage</strong> that can be accessed at the /tmp directory. This temporary storage is quite useful for caching any data that your function needs to process at every invocation. Imagine a Lambda function that downloads an S3 file into memory each time it is called. This is inefficient if the file is rarely updated and read by multiple users. Also, because of resource constraints or code performance issues, it is not always feasible to load large data into memory at once. To solve this, instead of directly consuming data from memory, store the data in the <code>/tmp</code> directory and process it in chunks. As a result, the next time the same file is requested, your Lambda function will simply retrieve it from its local storage rather than the S3 bucket.</p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/operatorguide/execution-environment.html>https://docs.aws.amazon.com/lambda/latest/operatorguide/execution-environment.html</a></li> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html>https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html</a></li> </ul> <h2 id=environment-variables>Environment variables<a class=headerlink href=#environment-variables title="Permanent link">&para;</a></h2> <p>An environment variable is a <code>key-value</code> pair that you can store and retrieve in your Lambda function. Environment variables are tied to a function and its specific version, which means no other functions can access it except for the function it is associated with. Environment variables are shared between execution environments that belong to the same function.</p> <p>A common scenario where environment variables are useful is when you want to configure different parameters for an application without touching the code. Say you have a Lambda function that needs to be tested against a development API before using the production API. In this case, instead of hardcoding the API endpoints and keys within the function code, you create two environment variables and pull them using the methods available to the programming language that you’re using. That way, you’d be able to change parameters tied to different environments without editing and redeploying your code. Just update the values of your environment variables. Making manual edits in the actual code isn’t a big deal, but it can be cumbersome and can lead to errors, so this environment variable is a nifty feature to help you write clean and reusable serverless functions.</p> <p>There are 4 things that you must consider when creating an environment variable:</p> <ol> <li>Keys must start with a letter and are at least two characters.</li> <li>Keys must consist of only letters, numbers, and the underscore character (_).</li> <li>There are environment variables that AWS Lambda uses during the INIT phase. These are called <a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html>reserved environment variables</a>. A key for a reserved environment variable cannot be used in your function configuration. For example, if you’re using an AWS SDK, you might define a variable called ‘AWS_REGION’. This will end up to an error since AWS_REGION is a reserved variable.</li> <li>The total size of all environment variables must not exceed 4 KB.</li> </ol> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html>https://docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html</a></li> <li><a href=https://aws.amazon.com/premiumsupport/knowledge-center/lambda-common-environment-variables/ >https://aws.amazon.com/premiumsupport/knowledge-center/lambda-common-environment-variables/</a></li> <li><a href=https://aws.amazon.com/premiumsupport/knowledge-center/lambda-environment-variables-iam-access/ >https://aws.amazon.com/premiumsupport/knowledge-center/lambda-environment-variables-iam-access/</a></li> </ul> <h2 id=lambda-function-url>Lambda function URL<a class=headerlink href=#lambda-function-url title="Permanent link">&para;</a></h2> <p>You can optionally configure an HTTPS endpoint (a.k.a <code>function URL</code>) that maps to a specific <a href=#versions-and-aliases>alias or version</a> of your Lambda function. Like any other URLs, function URLs can be accessed via web browsers or through HTTP clients like <code>urllib3</code>, <code>request</code> (in Python), or <code>axios</code> (in Node.Js).</p> <p>When you enable function URL, you get to choose between two auth types: <code>AWS_IAM</code> and <code>NONE</code>. <code>AWS_IAM</code>, as the name implies, is only applicable to IAM identities; the requester must be an IAM user or IAM role. AWS Lambda will make a decision on whether to grant access to a function based on the IAM user's or role's permissions.</p> <p>Function URLs with a <code>NONE</code> auth type, on the other hand, let a Lambda function be invoked publicly. At first glance, it sounds risky, and you may wonder why anyone would ever do this. When you use the NONE auth type, AWS Lambda is no longer responsible for authenticating requests. This gives you the freedom to implement your own authentication logic. You may, for example, allow access to your Lambda function to only those who are logged in to your website. Aside from that, you may also configure a <a href>CORS</a> setting to specify the domain/s from which invocation requests must originate.</p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-urls.html>https://docs.aws.amazon.com/lambda/latest/dg/lambda-urls.html</a></li> <li><a href=https://aws.amazon.com/blogs/aws/announcing-aws-lambda-function-urls-built-in-https-endpoints-for-single-function-microservices/ >https://aws.amazon.com/blogs/aws/announcing-aws-lambda-function-urls-built-in-https-endpoints-for-single-function-microservices/</a></li> </ul> <h2 id=deploying-codes-with-external-dependencies>Deploying Codes with External Dependencies<a class=headerlink href=#deploying-codes-with-external-dependencies title="Permanent link">&para;</a></h2> <p>As developers, whether you’re coding at work or building your own project, it is highly likely that you import at least one module, framework, or library. Libraries save time and make you more productive. You wouldn't want to reinvent the wheel and build functions from scratch unless you’re facing a unique case that has not been solved before. If you’re going to be building applications in AWS Lambda, it’s essential that you know how to include dependencies in your Lambda functions. </p> <p>There are dependencies that come prebuilt to a specific runtime and there are also external ones. The former can be used out of the box. The latter is usually downloaded from a public repository and installed on your computer. Often, this is done with the help of a package manager (e.g., npm for NodeJs , pip for Python ). AWS Lambda does not have a terminal where you can run pip/npm commands to install external dependencies on an execution environment. And it wouldn’t make sense to have one since Lambda functions are run on temporary environments.</p> <p>To deploy codes with external dependencies to AWS Lambda, do the following steps:</p> <ol> <li>Install all external dependencies locally on your application’s folder.</li> <li>Create a deployment package by zipping up the project folder. You can achieve this using the native Windows zip utility or zip command in Linux.</li> <li>Upload the deployment package to AWS Lambda. You can send the file directly to the AWS Lambda Console or store it first to Amazon S3 and deploy it from there.</li> </ol> <p>The first step is always the most important. See to it that you install dependencies required by your application locally on your folder and make sure that you correctly reference them in your code. If not done correctly, you might encounter an <code>Unable to import module error</code> , which could mean two things: it’s either you’ve placed the dependencies on a location that Lambda couldn’t find, or it is simply non-existent. </p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/python-package.html>https://docs.aws.amazon.com/lambda/latest/dg/python-package.html</a></li> <li><a href=https://aws.amazon.com/premiumsupport/knowledge-center/build-python-lambda-deployment-package/ >https://aws.amazon.com/premiumsupport/knowledge-center/build-python-lambda-deployment-package/</a></li> </ul> <h2 id=lambda-layers>Lambda Layers<a class=headerlink href=#lambda-layers title="Permanent link">&para;</a></h2> <p>Bundling external dependencies along with the function code gets the job done, but it has some drawbacks. First, deploying multiple Lambda functions that have the same dependencies is inefficient and would just bloat the total size of your functions. Second, updating dependencies takes time and effort. Updating each function that shares similar dependencies can slow down the development process. Lambda Layers solves these problems.</p> <p><img alt=image-20250108020803085 src=../assets/image-20250108020803085.png></p> <p>Lambda Layers lets you store any additional code (e.g., external dependencies, custom runtimes) separately from your deployment package. Just like a deployment package, external dependencies must be in zip format before being uploaded to AWS Lambda.</p> <p>Lambda layers can be shared among Lambda functions, making it convenient and easy to update dependencies. In addition, the deployment process becomes more modularized, and your deployment package becomes significantly smaller.</p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/serverlessrepo/latest/devguide/sharing-lambda-layers.html>https://docs.aws.amazon.com/serverlessrepo/latest/devguide/sharing-lambda-layers.html</a></li> <li><a href=https://aws.amazon.com/blogs/aws/new-for-aws-lambda-use-any-programming-language-and-share-common-components>https://aws.amazon.com/blogs/aws/new-for-aws-lambda-use-any-programming-language-and-share-common-components</a></li> </ul> <h2 id=concurrency-and-throttling>Concurrency and Throttling<a class=headerlink href=#concurrency-and-throttling title="Permanent link">&para;</a></h2> <p>AWS Lambda is inherently scalable, but like many other things, there’s a limit to how much it can scale to. It is important that you become aware of this, especially when you’re building a high-throughput application using Lambda functions.</p> <p>Concurrency is the number of Lambda function executions that can run simultaneously for a period of time. By default, AWS imposes a <strong>limit of 1,000 unreserved concurrent executions</strong> across all Lambda functions <strong>for every region per account</strong>. But you can overcome this limit and further increase concurrent executions up to hundreds of thousands by contacting AWS Support.</p> <p>You can strategically distribute concurrencies across your functions, but the <strong>unreserved count</strong> should not go below <strong>100</strong>. This means that the default maximum value of allowable <strong>reserved concurrent executions</strong> is limited to <strong>900</strong>. The reserved concurrent executions allocated to a function set the maximum number of concurrent instances for that function.</p> <p>Example:</p> <ul> <li><strong>Lambda function A</strong><ul> <li>reads and uploads files to Amazon S3.</li> <li>150 concurrent executions are reserved for this function.</li> </ul> </li> <li><strong>Lambda function B</strong><ul> <li>writes and updates items in a DynamoDB table</li> <li>250 concurrent executions are reserved for this function.</li> </ul> </li> <li><strong>Lambda function C</strong><ul> <li>processes HTTP requests from API Gateway</li> <li>unreserved concurrency.</li> </ul> </li> </ul> <p>Simply adding the concurrent executions of functions A and B gives us a total reserved concurrency of 400. That leaves us with 600 unreserved concurrency executions. So what happens when the demand for Lambda function A exceeds 150 concurrent executions? This is where throttling comes into play. When a function hits its maximum concurrency limit, AWS Lambda will reject incoming invocations and return a 429 status code throttling error. It is not possible for Lambda function A to borrow from the remaining unreserved concurrency pool.</p> <p>When computing the Concurrency limits for a Lambda function, consider two things:</p> <ol> <li>Execution time</li> <li>Number of requests handled per second (requests per second)</li> </ol> <p>Example:</p> <ul> <li>Lambda function<ul> <li>processes HTTP requests from API Gateway with unreserved concurrency</li> <li>Expects an average execution time of 10 seconds</li> <li>Expects 150 requests per second.</li> </ul> </li> </ul> <p>Multiplying the average execution time by the number of requests per second gives us 1,500 concurrency executions. This is beyond the default limit. If you bring this function to production, you’ll end up with a lot of failed requests due to throttling. One of the things you could try doing in this scenario is to optimize the Lambda code and hope to reduce the execution time. A sure alternative would be to increase the default limit by contacting AWS Support.</p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html>https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html</a></li> <li><a href=https://aws.amazon.com/blogs/compute/managing-aws-lambda-function-concurrency/ >https://aws.amazon.com/blogs/compute/managing-aws-lambda-function-concurrency/</a></li> </ul> <h2 id=connecting-a-lambda-function-to-a-vpc>Connecting a Lambda Function to a VPC<a class=headerlink href=#connecting-a-lambda-function-to-a-vpc title="Permanent link">&para;</a></h2> <p>If you want your Lambda function to interact with resources (e.g., RDS database, EC2 instance) inside a private subnet, you won't be able to do so by default. The reason for this is that Lambda functions live in an isolated and secured VPC managed by AWS. This is why when you create a Lambda function, you don’t go through any networking configurations (VPC, subnet, ENIs), unlike when creating EC2 instances. You cannot establish a VPC peering connection between the VPC where Lambda functions are run and the VPC where your private resources are located because the former is not accessible to customers. The proper way is to configure your function to connect to a VPC.</p> <p>To connect your Lambda function to a VPC, first, make sure that your function’s execution role has the required permissions to manage the creation and deletion of Elastic Network Interfaces (ENI). This is needed because AWS Lambda creates and deletes elastic network interfaces on subnets that you specify in your function’s VPC configuration. AWS uses an internal service called AWS Hyperplane, which serves as a NAT service, connecting Lambda functions to the ENIs in your VPC. Thankfully, there’s the <code>AWSLambdaVPCAccessExecutionRole</code> managed IAM policy, which contains the permissions needed for the job.</p> <p>Next, specify the VPC where your private resources are located under the Lambda function’s network settings. When you create a VPC configuration, you get to choose the subnets where the ENIs are deployed and a security group that controls the traffic between your Lambda function and VPC. </p> <p><img alt src=../assets/image-20250108021600095.png></p> <p>Once connected, your Lambda function will lose internet access. This happens due to the fact that AWS Lambda only assigns private IP addresses to ENIs that it creates. Even if your function is connected to a public subnet, your VPC's internet gateway will still be unable to route traffic between the internet and your function. To give your Lambda function internet access, create a NAT Gateway in the public subnet of your function's VPC and add an entry to the private subnet's route table. Set 0.0.0.0/0 as the destination and the NAT Gateway as the target.</p> <p><img alt=image-20250108021631601 src=../assets/image-20250108021631601.png></p> <p><strong>References:</strong></p> <ul> <li><a href=https://aws.amazon.com/premiumsupport/knowledge-center/internet-access-lambda-function>https://aws.amazon.com/premiumsupport/knowledge-center/internet-access-lambda-function</a></li> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html>https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html</a></li> </ul> <h2 id=versions-and-aliases>Versions and Aliases<a class=headerlink href=#versions-and-aliases title="Permanent link">&para;</a></h2> <p>Revisions are almost unavoidable when developing applications, whether you’re adding new features or fixing bugs. Instead of directly making changes to the stable version of your Lambda function, you can publish new versions of it where you can play around and experiment at will without affecting the stable version. </p> <p>A version is a snapshot of a Lambda function’s state at a given time. When you publish a new version, a :version-number suffix is appended to your function’s ARN, which indicates its version. An example is shown below:</p> <div class=highlight><pre><span></span><code>arn:aws:lambda:us-east-2:123456789123:function:cool-function :1
</code></pre></div> <p>AWS Lambda assigns version numbers monotonically. This means that if you delete a version and publish another one, the sequencing of numbers as you add versions will not reset; rather, it’ll just increment.</p> <p>The unpublished version is also referred to as the <code>$LATEST</code> version. If you call a function without any suffix, AWS Lambda will implicitly invoke the <code>$LATEST</code>version. Take note that published versions are immutable; any modifications to the code or function configuration are not possible. If you want to make code or config updates, apply the changes to the <code>$LATEST</code> version and publish it as another version.</p> <p><img alt=image-20250108021838211 src=../assets/image-20250108021838211.png></p> <p>The problem with versions is that you have no control over what is appended to the function's ARN. It can be bothersome to have to update the function's ARN in your code or app parameters every time a new version is released. Wouldn't it be great if there’s a pointer that we can use to switch between versions? In this way, you can simply set and forget the ARN of the function. This is where Aliases come into play. You can think of an alias as a nickname that you give to a version number. </p> <p>To invoke a function with an alias, simply append a <code>:alias-name</code> suffix to your function’s ARN, just like the example below:</p> <div class=highlight><pre><span></span><code>arn :aws:lambda:us-east-2:123456789123:function:cool-function : PROD
</code></pre></div> <p>You can change the version that the alias is pointing to in the Lambda Console or via the UpdateAlias API.</p> <p><strong>References:</strong></p> <ul> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-aliases.html>https://docs.aws.amazon.com/lambda/latest/dg/configuration-aliases.html</a></li> <li><a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-versions.html>https://docs.aws.amazon.com/lambda/latest/dg/configuration-versions.html</a></li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 15, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 15, 2025</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../AWS%20STS/ class="md-footer__link md-footer__link--prev" aria-label="Previous: AWS STS"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> AWS STS </div> </div> </a> <a href=../Amazon%20API%20Gateway/ class="md-footer__link md-footer__link--next" aria-label="Next: Amazon API Gateway‬"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Amazon API Gateway‬ </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright Javier Vanoli © 2025 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.linkedin.com/in/javiervanoli/ target=_blank rel=noopener title="Find me on LinkedIn!" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.06 2.06 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065m1.782 13.019H3.555V9h3.564zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0z"/></svg> </a> <a href=mailto:jvanoli@dinounou.com target=_blank rel=noopener title="Send me an E-Mail!" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.8l167.6-182.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.footer", "navigation.path", "search.share", "search.highlight", "search.suggest", "toc.follow", "content.action.edit"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.88dd0f4e.min.js></script> </body> </html>